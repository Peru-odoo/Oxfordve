<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="commission_report_view_pivot" model="ir.ui.view">
            <field name="name">commission.report.view.pivot</field>
            <field name="model">sale.order.line</field>
            <field name="arch" type="xml">
                <pivot string="Comisiones por ventas" display_quantity="0" sample="1">

                    <field name="categ_id" type="row" />
                    <field name="product_id" type="row" />
                    <field name="date" interval="month" type="row" />
                    <field name="team_id" type="col" />
                    <field name="total_vendidos" type="measure" />
                    <field name="total_amount_commissions" type="measure" />
                </pivot>
            </field>
        </record>

        <record id="product_normal_form_view_inherit" model="ir.ui.view">
            <field name="name">product.normal.form.view.inherit</field>
            <field name="model">product.product</field>
            <field name="mode">extension</field>
            <field name="priority" eval="8" />
            <field name="inherit_id" ref="product.product_normal_form_view" />
            <field name="arch" type="xml">

                <xpath expr="//page[@name='invoicing']" position="after">
                    <page name="commissions" string="Comisiones">
                        <field name="commission_ids" widget="one2many"
                            context="{'show_attribute': False}"
                            string=" Comisiones asociadas">
                            <tree string="Comisiones">
                                <field name="name" />
                                <field name="commission_type" />
                                <field name="product_id" />
                                <field name="categ_id" />
                                <field name="cant_minima_base" />
                                <field name="bono_base" />
                                <field name="basado_en" />
                                <field name="cant_min_base_otra_com" />
                                <field name="bono_base_otra_com" />
                                <field name="forma_de_calculo" />
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>


        <record id="agrupated_product_view_form" model="ir.ui.view">
            <field name="name">agrupated.product.view.form</field>
            <field name="model">agrupated.product</field>
            <field name="arch" type="xml">
                <form string="Agrupado con">
                    <div class="row">
                        <div class="col-md-6">
                            <group>
                                <field name="product_id" />
                            </group>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <group>
                                <field name="commission_id" />
                            </group>
                        </div>
                    </div>
                </form>
            </field>
        </record>


        <record id="commission_for_sale_view_tree" model="ir.ui.view">
            <field name="name">commission.for.sale.view.tree</field>
            <field name="model">commission.for.sale</field>
            <field name="arch" type="xml">
                <tree string="Comisiones" create="0">
                    <field name="name">
                    </field>
                    <field name="commission_type">
                    </field>
                    <field name="categ_id">
                    </field>
                    <field name="product_id">
                    </field>
                    <field name="cant_minima_base">
                    </field>
                    <field name="bono_base">
                    </field>
                    <field name="basado_en">
                    </field>
                    <field name="cant_min_base_otra_com">
                    </field>
                    <field name="bono_base_otra_com">
                    </field>
                    <field name="forma_de_calculo">
                    </field>
                </tree>
            </field>
        </record>

        <record id="commission_for_sale_view_form" model="ir.ui.view">
            <field name="name">commission.for.sale.view.form</field>
            <field name="model">commission.for.sale</field>
            <field name="arch" type="xml">
                <form string="Comisión" create="0" edit="1">

                    <div class="row">
                        <div class="col-md-6">
                            <group>
                                <field name="name" />
                            </group>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <group>
                                <field name="commission_type" widget='radio' />
                            </group>
                        </div>
                        <div class="col-md-6">
                            <group>
                                <field name="product_id" />
                                <field name="categ_id" />
                                <field name="basado_en"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')], 'required': [('commission_type', '=', 'basada_en_otra_comision')]}" />
                            </group>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-2.01" style="margin-left:15px;">
                            <group>
                                <h1>
                                    <div attrs="{'invisible': [('commission_type', '=', 'fija')]}"
                                        style="font-size:40%;"> Cantidad mínima base </div>
                                </h1>
                            </group>
                        </div>

                        <div class="col-md-4" style="margin-left:40px; margin-top:1px;">
                            <group>
                                <field name="cant_min_base_factor_divisor"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                                <field name="cant_min_base_factor_multiplicador"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                                <field name="cant_min_base_factor_extra"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                                <field name="cant_min_base_otra_com"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                            </group>
                        </div>

                        <div class="col-md-5.99" style="margin-left:1px;">
                            <group></group>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-2">
                            <group>
                                <h1>
                                    <div attrs="{'invisible': [('commission_type', '=', 'fija')]}"
                                        style="font-size:40%;"> Bono base </div>
                                </h1>
                            </group>
                        </div>

                        <div class="col-md-4" style="margin-left:20px;">
                            <group>
                                <field name="bono_base_factor_divisor"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                                <field name="bono_base_factor_multiplicador"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                                <field name="bono_base_factor_extra"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                                <field name="bono_base_otra_com"
                                    attrs="{'invisible': [('commission_type', '=', 'fija')]}" />
                            </group>
                        </div>
                        <div class="col-md-6" style="margin-left:1px;">
                            <group></group>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <group>
                                <field name="cant_minima_base"
                                    attrs="{'invisible': [('commission_type', '=', 'basada_en_otra_comision')]}"
                                    required='1' />
                                <field name="bono_base"
                                    attrs="{'invisible': [('commission_type', '=', 'basada_en_otra_comision')]}"
                                    required='1' />
                            </group>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <group>
                                <field name="forma_de_calculo" widget='radio' required='1' />
                            </group>
                        </div>
                    </div>

                    <!-- <div class="row">
                        <div class="col-md-8">
                            <group>
                    <field name="agrupated_product_ids"
                                       mode="tree,form"
                    string="Agrupado con">
                                    <form>
                                        <field
                    name="product_id" readonly="0"
                                        options="{'no_create':
                    False, 'no_open': False}"/>  
                                        <field
                    name="commission_id"/>
                                    </form>
                
                                    <tree
                    string="Producto"
                                           editable="bottom">
                    <control>
                                            <create
                    name="add_product_control" string="Agregar un producto_"/>
                                        </control>
                    <field name="product_id" readonly="0"
                                        options="{'no_create':
                    False, 'no_open': False}"                                        
                                               />
                    <field name="commission_id" invisible="1"/>
                                    </tree>
                    </field>   
                            </group>
                        </div>
                    </div> -->
                </form>
            </field>
        </record>

        <record id="product_template_product_tree_inherit" model="ir.ui.view">
            <field name="name">product.template.product.tree.inherit</field>
            <field name="model">product.template</field>
            <field name="mode">extension</field>
            <field name="priority" eval="17" />
            <field name="inherit_id" ref="product.product_template_tree_view" />
            <field name="arch" type="xml">

                <xpath expr="//field[@name='uom_id']" position="after">
                    <field name="total_commissions" />
                </xpath>
            </field>
        </record>

        <record id="account_view_move_line_form" model="ir.ui.view">
            <field name="name">account.view.move.line.form</field>
            <field name="model">account.move.line</field>
            <field name="mode">extension</field>
            <field name="priority" eval="3" />
            <field name="inherit_id" ref="account.view_move_line_form" />
            <field name="arch" type="xml">                
                <xpath expr="//field[@name='statement_id']" position="after">
                    <field name="payment_state"></field>                    
                </xpath>
            </field>
        </record>

        <record id="account_view_move_line_tree_inherit" model="ir.ui.view">
            <field name="name">account.view.move.line.tree.inherit</field>
            <field name="model">account.move.line</field>
            <field name="mode">extension</field>
            <field name="priority" eval="101" />
            <field name="inherit_id" ref="account.view_move_line_tree" />
            <field name="arch" type="xml">
    
                <xpath expr="//field[@name='parent_state']" position="after">
                    <field name="payment_state"></field>
                </xpath>
                <xpath expr="//field[@name='branch_id']" position="after">
                    <field name="team_id"></field>
                </xpath>
                <!-- <xpath expr="//field[@name='branch_id']" position="attributes">
                    <attribute name="domain">[('id', 'in', [b for b in user_id.branch_ids] )]</attribute>
                </xpath> -->
            </field>
        </record>

        <record id="product_product_tree_view_inherit" model="ir.ui.view">
            <field name="name">product.product.tree.view.inherit</field>
            <field name="model">product.product</field>
            <field name="mode">extension</field>
            <field name="priority" eval="8" />
            <field name="inherit_id" ref="product.product_product_tree_view" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='uom_id']" position="after">
                    <field name="total_commissions" />
                </xpath>
            </field>
        </record>

        <record id="res_config_settings_view_form_configuration_cobranza" model="ir.ui.view">
            <field name="name">res.config.settings.view.form.view.configuration.cobranza</field>
            <field name="model">configuration.cobranza</field>
            <field name="arch" type="xml">
                <form string="Configuración" create='0' edit='1' delete='0'>
                    <div class="app_settings_block">
                        <h2>Porcentaje</h2>
                        <div name="porcentaje">
                            <div class="col-12 col-lg-6"
                                id="percentage"
                                title="Porcentaje a pagar en las cobranzas">
                                <div>
                                    <field name="percentage" widget="percentage" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="app_settings_block">
                        <h2>Cuentas contables</h2>
                        <div name="cuentas">
                            <div class="col-12 col-lg-6"
                                id="cuentas"
                                title="Cuentas contables">
                                <div>
                                    <field name="account_ids"
                                        string="Cuentas contables a considerar"
                                        widget="many2many_tags" />
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </field>
        </record>
    </data>
</odoo>